(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{1119:function(e,t,r){e.exports={}},1322:function(e,t,r){"use strict";r(1119)},1465:function(e,t,r){"use strict";r.r(t);var n,o,m,l=r(0),c=(r(8),r(23),r(117)),d={name:"Comments",data:function(){return{comments:[],formCreate:{name:"",message:""},isFormCreate:!1,isListComments:!1}},validations:function(){return{formCreate:{name:{required:c.required},message:{required:c.required}}}},props:{model:{type:String,default:""},modelKey:{type:[String,Number],default:""}},computed:{isVisible:function(){var e,t,r;return Boolean(null===(e=this.$store.state)||void 0===e||null===(t=e.user)||void 0===t||null===(r=t.user)||void 0===r?void 0:r.id)},errorName:function(){var e,t,r=null===(e=this.$v)||void 0===e||null===(t=e.formCreate)||void 0===t?void 0:t.name;return null!=r&&r.$invalid&&null!=r&&r.$dirty?r.required?null:this.$t("errorsValidationForms.requiredForFill"):null},errorMessage:function(){var e,t,r=null===(e=this.$v)||void 0===e||null===(t=e.formCreate)||void 0===t?void 0:t.message;return null!=r&&r.$invalid&&null!=r&&r.$dirty?r.required?null:this.$t("errorsValidationForms.requiredForFill"):null}},mounted:(m=Object(l.a)((function*(){yield this.getComments()})),function(){return m.apply(this,arguments)}),methods:{getComments:(o=Object(l.a)((function*(){var e=yield this.$api.agent.transport.get("/reviews?filter[model]=".concat(this.model,"&filter[model_key]=").concat(this.modelKey)).then((e=>e.data)).catch((()=>[]));this.comments=e})),function(){return o.apply(this,arguments)}),changeIsListComments:function(){this.isListComments=!this.isListComments},createComment:(n=Object(l.a)((function*(){if(this.$v.$touch(),this.$v.$invalid)return null;this.$store.commit("loading/setLoading",!0);var e=this.$store.state.user.user,body={name:this.formCreate.name,email:null==e?void 0:e.email,text:this.formCreate.message,entities:[{model:this.model,model_key:this.modelKey}]};yield this.$api.agent.transport.post("/reviews",body).then((e=>e.data)).catch((e=>({error:e.response}))),this.formCreate={name:"",message:""},this.isFormCreate=!1,this.$v.$reset(),this.$store.commit("loading/setLoading",!1),this.$toast.success(this.$t("comments.send_comment_moderation"))})),function(){return n.apply(this,arguments)}),openFormCreate:function(){this.isFormCreate=!0},_parseDate:function(e){var t=1e3*e.published_at,r=this.$i18n.locale;return new Date(t).toLocaleString(r,{day:"numeric",month:"long",year:"numeric"}).split(",").join(" ")}}},v=d,_=(r(1322),r(4)),component=Object(_.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"comments"},[r("div",{staticClass:"comments__create",class:{"--open":e.isFormCreate}},[e.isFormCreate?e._e():[r("div",{staticClass:"--button",on:{click:e.openFormCreate}},[e._v("\n        "+e._s(e.$t("comments.add_comment"))+"\n      ")])],e._v(" "),e.isFormCreate&&e.isVisible?[r("div",{staticClass:"--title"},[e._v(e._s(e.$t("comments.add_comment")))]),e._v(" "),r("div",{staticClass:"--body"},[r("div",{staticClass:"--left"},[r("div",{staticClass:"--input",class:{"--error":Boolean(e.errorName)}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.formCreate.name,expression:"formCreate.name"}],attrs:{type:"text",placeholder:e.$t("registration.nameInputPlaceholder")},domProps:{value:e.formCreate.name},on:{input:function(t){t.target.composing||e.$set(e.formCreate,"name",t.target.value)}}}),e._v(" "),e.errorName?r("div",{staticClass:"--error-text"},[e._v(e._s(e.errorName))]):e._e()]),e._v(" "),r("button",{staticClass:"btn btn-primary --pc",on:{click:e.createComment}},[e._v("\n            "+e._s(e.$t("feedbackForm.buttonSend"))+"\n          ")])]),e._v(" "),r("div",{staticClass:"--right"},[r("div",{staticClass:"--input",class:{"--error":Boolean(e.errorMessage)}},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.formCreate.message,expression:"formCreate.message"}],attrs:{type:"text",placeholder:e.$t("feedbackForm.messagePlaceholder")},domProps:{value:e.formCreate.message},on:{input:function(t){t.target.composing||e.$set(e.formCreate,"message",t.target.value)}}}),e._v(" "),e.errorMessage?r("div",{staticClass:"--error-text"},[e._v(e._s(e.errorMessage))]):e._e()]),e._v(" "),r("button",{staticClass:"btn btn-primary --mobile",on:{click:e.createComment}},[e._v("\n            "+e._s(e.$t("feedbackForm.buttonSend"))+"\n          ")])])])]:e._e(),e._v(" "),e.isFormCreate&&!e.isVisible?[r("div",{staticClass:"--title"},[e._v(e._s(e.$t("comments.add_comment")))]),e._v(" "),r("div",{staticClass:"--message"},[e._v("\n        "+e._s(e.$t("comments.ony_auth_user"))+"\n      ")])]:e._e()],2),e._v(" "),r("div",{staticClass:"comments__list"},[r("div",{staticClass:"--head"},[r("div",{staticClass:"--title"},[e._v("\n        "+e._s(e.$t("comments.comments"))+" "),r("span",[e._v(e._s(e.comments.length))])]),e._v(" "),r("button",{staticClass:"btn btn-primary --button",on:{click:e.changeIsListComments}},[e._v("\n        "+e._s(e.isListComments?e.$t("comments.collapse"):e.$t("comments.expand"))+"\n      ")])]),e._v(" "),e.isListComments?r("div",{staticClass:"--list"},[e._l(e.comments,(function(t){return[r("div",{staticClass:"comment-card"},[r("div",{staticClass:"--name"},[e._v(e._s(t.name))]),e._v(" "),r("div",{staticClass:"--message",domProps:{innerHTML:e._s(t.text)}}),e._v(" "),r("div",{staticClass:"--date"},[e._v(e._s(e._parseDate(t)))])])]}))],2):e._e()])])}),[],!1,null,"d4547c4a",null);t.default=component.exports}}]);
//# sourceMappingURL=blog-comments-9b39c1d.modern.js.map