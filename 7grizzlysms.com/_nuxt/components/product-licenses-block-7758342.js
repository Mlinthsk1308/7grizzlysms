(window.webpackJsonp=window.webpackJsonp||[]).push([[170],{1182:function(e,t,n){e.exports={}},1379:function(e,t,n){e.exports=n.p+"img/infinity.bf8beca.svg"},1380:function(e,t,n){"use strict";n(1182)},1538:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(3),o=n(10),l=(n(11),n(361),n(19),n(33),n(364),n(366),n(367),n(368),n(369),n(370),n(371),n(372),n(373),n(374),n(375),n(376),n(377),n(31),n(25),n(20),n(22),n(15),n(13),n(38),n(597)),d=n(973);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function _(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f=l.a.extend({name:"ProductLicensesBlock",data:function(){return{isLoading:!1}},computed:{isUserAuth:function(){return this.$store.getters["user/isLoggedIn"]},licenseList:function(){var e=[],t=Object(o.a)(this.extras.items),n=new Map;return t.forEach((function(e){var t;n.set(null==e||null===(t=e.license)||void 0===t?void 0:t.id,_(_({},null==e?void 0:e.license),{},{count:null==e?void 0:e.license_items_count}))})),Object(o.a)(this.values.products).forEach((function(t){var r=n.get(t.license);r&&e.push(_(_({},t),{},{price:r,count:(null==r?void 0:r.count)||0}))})),e}},methods:{onBuyLicense:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,c,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.isLoading=!0,t.isUserAuth){n.next=5;break}return n.next=4,t.$router.push(t.localePath("/registration?goback=1"));case 4:return n.abrupt("return");case 5:return n.next=7,t.checkUserBalance(null==e||null===(r=e.price)||void 0===r?void 0:r.price);case 7:if(n.sent){n.next=10;break}return n.abrupt("return");case 10:return n.next=12,t.$api.agent.transport("license/get/".concat(null==e||null===(c=e.price)||void 0===c?void 0:c.id)).catch((function(e){return{error:Object(d.a)(e.response)}}));case 12:if(!(o=n.sent).error){n.next=17;break}return t.isLoading=!1,t.$toast.error(o.error),n.abrupt("return");case 17:t.$root.$emit("getBalance"),t.$toast.success(t.$t("license.licenseSuccess")),t.isLoading=!1;case 20:case"end":return n.stop()}}),n)})))()},checkUserBalance:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.$api.agent.transport.get("sms-users/balance").then((function(e){return e.data})).catch((function(){return 0}));case 2:if(!(n.sent<+e)){n.next=7;break}return n.next=6,t.$router.push(t.localePath("/profile/pay"));case 6:return n.abrupt("return",!1);case 7:return n.abrupt("return",!0);case 8:case"end":return n.stop()}}),n)})))()}}}),h=(n(1380),n(5)),component=Object(h.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.licenseList&&e.licenseList.length?r("section",{staticClass:"product-licenses-block"},[r("div",{staticClass:"container --small"},[r("div",{staticClass:"product-licenses-block__content"},[r("h2",{staticClass:"product-licenses-block__title"},[e._v(e._s(e.values.title))]),e._v(" "),r("div",{staticClass:"product-licenses-block__block"},[r("div",{staticClass:"product-licenses-block__list"},e._l(e.licenseList,(function(t,c){return r("div",{key:"product-license-card-"+c,staticClass:"product-license-card"},[r("div",{staticClass:"product-license-card__head"},[r("div",{staticClass:"--title"},[t.is_infinity?r("img",{attrs:{src:n(1379)}}):e._e(),e._v("\n                "+e._s(t.title)+"\n              ")]),e._v(" "),r("div",{staticClass:"--price"},[e._v("\n                "+e._s(e.$numberFormat(t.price.price,0,",","."))+" "),r("span",[e._v("â‚½")])])]),e._v(" "),r("div",{staticClass:"product-license-card__body"},[r("ul",e._l(t.list,(function(t,n){return r("li",{key:"product-license-card-"+n+"-li-"+n},[r("span",[e._v(e._s(t.value))])])})),0),e._v(" "),r("div",{staticClass:"product-license-card__count"},[e._v("\n                "+e._s(e.$t("productLicensesBlock.availableAt"))+" Grizzly SMS: "),r("span",[e._v(e._s(t.count)+" "+e._s(e.$t("servicesList.quantity"))+".")])]),e._v(" "),r("button",{staticClass:"btn btn-primary product-license-card__button",attrs:{disabled:e.isLoading},on:{click:function(){return e.onBuyLicense(t)}}},[e._v("\n                "+e._s(e.$t("license.buyKey"))+"\n              ")]),e._v(" "),t.tip?r("div",{staticClass:"product-license-card__annotation",domProps:{innerHTML:e._s(t.tip)}}):e._e()])])})),0)])])])]):e._e()}),[],!1,null,"149bcee3",null);t.default=component.exports}}]);
//# sourceMappingURL=product-licenses-block-7758342.js.map